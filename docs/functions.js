!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.functions=n():e.functions=n()}(this,(function(){return function(){"use strict";var e={d:function(n,t){for(var i in t)e.o(t,i)&&!e.o(n,i)&&Object.defineProperty(n,i,{enumerable:!0,get:t[i]})},o:function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};function t(e){const{credentials:n="same-origin",referrer:t,referrerPolicy:r,shouldRetry:o=()=>!1}=e,a=e.fetchFn||fetch,s=e.abortControllerImpl||AbortController,c=(()=>{let e=!1;const n=[];return{get disposed(){return e},onDispose(t){return e?(setTimeout((()=>t()),0),()=>{}):(n.push(t),()=>{n.splice(n.indexOf(t),1)})},dispose(){if(!e){e=!0;for(const e of[...n])e()}}}})();return{subscribe(u,l){if(c.disposed)throw new Error("Client has been disposed");const d=new s,m=c.onDispose((()=>{m(),d.abort()}));return(async()=>{var s;let c=null,m=0;for(;;){if(c){const e=await o(c,m);if(d.signal.aborted)return;if(!e)throw c;m++}try{const o="function"==typeof e.url?await e.url(u):e.url;if(d.signal.aborted)return;const c="function"==typeof e.headers?await e.headers():null!==(s=e.headers)&&void 0!==s?s:{};if(d.signal.aborted)return;let m;try{m=await a(o,{signal:d.signal,method:"POST",headers:Object.assign(Object.assign({},c),{"content-type":"application/json; charset=utf-8",accept:"application/graphql-response+json, application/json"}),credentials:n,referrer:t,referrerPolicy:r,body:JSON.stringify(u)})}catch(e){throw new i(e)}if(!m.ok)throw new i(m);if(!m.body)throw new Error("Missing response body");const y=m.headers.get("content-type");if(!y)throw new Error("Missing response content-type");if(!y.includes("application/graphql-response+json")&&!y.includes("application/json"))throw new Error(`Unsupported response content-type ${y}`);const p=await m.json();return l.next(p),d.abort()}catch(e){if(d.signal.aborted)return;if(!(e instanceof i))throw e;c=e}}})().then((()=>l.complete())).catch((e=>l.error(e))),()=>d.abort()},dispose(){c.dispose()}}}e.r(n),e.d(n,{accountBalance:function(){return me},accountList:function(){return ue},accountPnl:function(){return de},deriveFuturesSymbol:function(){return ye},initializeClient:function(){return re},marketBBO:function(){return oe},marketMid:function(){return se},marketTicker:function(){return ce},remakeClient:function(){return ie},searchSymbols:function(){return pe},streamAccountPositionValues:function(){return le},streamFillsAnalysis:function(){return fe},streamMarketTicker:function(){return ae}});class i extends Error{constructor(e){let n,t;var i;!function(e){return"object"==typeof e&&null!==e}(i=e)||"boolean"!=typeof i.ok||"number"!=typeof i.status||"string"!=typeof i.statusText?n=e instanceof Error?e.message:String(e):(t=e,n="Server responded with "+e.status+": "+e.statusText),super(n),this.name=this.constructor.name,this.response=t}}var r,o,a="Document",s="FragmentDefinition";class c extends Error{constructor(e,n,t,i,r,o,a){super(e),this.name="GraphQLError",this.message=e,r&&(this.path=r),n&&(this.nodes=Array.isArray(n)?n:[n]),t&&(this.source=t),i&&(this.positions=i),o&&(this.originalError=o);var s=a;if(!s&&o){var c=o.extensions;c&&"object"==typeof c&&(s=c)}this.extensions=s||{}}toJSON(){return{...this,message:this.message}}toString(){return this.message}get[Symbol.toStringTag](){return"GraphQLError"}}function u(e){return new c(`Syntax Error: Unexpected token at ${o} in ${e}`)}function l(e){if(e.lastIndex=o,e.test(r))return r.slice(o,o=e.lastIndex)}var d=/ +(?=[^\s])/y;function m(e){for(var n=e.split("\n"),t="",i=0,r=0,o=n.length-1,a=0;a<n.length;a++)d.lastIndex=0,d.test(n[a])&&(a&&(!i||d.lastIndex<i)&&(i=d.lastIndex),r=r||a,o=a);for(var s=r;s<=o;s++)s!==r&&(t+="\n"),t+=n[s].slice(i).replace(/\\"""/g,'"""');return t}function y(){for(var e=0|r.charCodeAt(o++);9===e||10===e||13===e||32===e||35===e||44===e||65279===e;e=0|r.charCodeAt(o++))if(35===e)for(;10!==(e=r.charCodeAt(o++))&&13!==e;);o--}function p(){for(var e=o,n=0|r.charCodeAt(o++);n>=48&&n<=57||n>=65&&n<=90||95===n||n>=97&&n<=122;n=0|r.charCodeAt(o++));if(e===o-1)throw u("Name");var t=r.slice(e,--o);return y(),t}function f(){return{kind:"Name",value:p()}}var h=/(?:"""|(?:[\s\S]*?[^\\])""")/y,v=/(?:(?:\.\d+)?[eE][+-]?\d+|\.\d+)/y;function g(e){var n;switch(r.charCodeAt(o)){case 91:o++,y();for(var t=[];93!==r.charCodeAt(o);)t.push(g(e));return o++,y(),{kind:"ListValue",values:t};case 123:o++,y();for(var i=[];125!==r.charCodeAt(o);){var a=f();if(58!==r.charCodeAt(o++))throw u("ObjectField");y(),i.push({kind:"ObjectField",name:a,value:g(e)})}return o++,y(),{kind:"ObjectValue",fields:i};case 36:if(e)throw u("Variable");return o++,{kind:"Variable",name:f()};case 34:if(34===r.charCodeAt(o+1)&&34===r.charCodeAt(o+2)){if(o+=3,null==(n=l(h)))throw u("StringValue");return y(),{kind:"StringValue",value:m(n.slice(0,-3)),block:!0}}var s,c=o;o++;var d=!1;for(s=0|r.charCodeAt(o++);92===s&&(o++,d=!0)||10!==s&&13!==s&&34!==s&&s;s=0|r.charCodeAt(o++));if(34!==s)throw u("StringValue");return n=r.slice(c,o),y(),{kind:"StringValue",value:d?JSON.parse(n):n.slice(1,-1),block:!1};case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:for(var b,S=o++;(b=0|r.charCodeAt(o++))>=48&&b<=57;);var E=r.slice(S,--o);if(46===(b=r.charCodeAt(o))||69===b||101===b){if(null==(n=l(v)))throw u("FloatValue");return y(),{kind:"FloatValue",value:E+n}}return y(),{kind:"IntValue",value:E};case 110:if(117===r.charCodeAt(o+1)&&108===r.charCodeAt(o+2)&&108===r.charCodeAt(o+3))return o+=4,y(),{kind:"NullValue"};break;case 116:if(114===r.charCodeAt(o+1)&&117===r.charCodeAt(o+2)&&101===r.charCodeAt(o+3))return o+=4,y(),{kind:"BooleanValue",value:!0};break;case 102:if(97===r.charCodeAt(o+1)&&108===r.charCodeAt(o+2)&&115===r.charCodeAt(o+3)&&101===r.charCodeAt(o+4))return o+=5,y(),{kind:"BooleanValue",value:!1}}return{kind:"EnumValue",value:p()}}function b(e){if(40===r.charCodeAt(o)){var n=[];o++,y();do{var t=f();if(58!==r.charCodeAt(o++))throw u("Argument");y(),n.push({kind:"Argument",name:t,value:g(e)})}while(41!==r.charCodeAt(o));return o++,y(),n}}function S(e){if(64===r.charCodeAt(o)){var n=[];do{o++,n.push({kind:"Directive",name:f(),arguments:b(e)})}while(64===r.charCodeAt(o));return n}}function E(){for(var e=0;91===r.charCodeAt(o);)e++,o++,y();var n={kind:"NamedType",name:f()};do{if(33===r.charCodeAt(o)&&(o++,y(),n={kind:"NonNullType",type:n}),e){if(93!==r.charCodeAt(o++))throw u("NamedType");y(),n={kind:"ListType",type:n}}}while(e--);return n}function I(){if(123!==r.charCodeAt(o++))throw u("SelectionSet");return y(),T()}function T(){var e=[];do{if(46===r.charCodeAt(o)){if(46!==r.charCodeAt(++o)||46!==r.charCodeAt(++o))throw u("SelectionSet");switch(o++,y(),r.charCodeAt(o)){case 64:e.push({kind:"InlineFragment",typeCondition:void 0,directives:S(!1),selectionSet:I()});break;case 111:110===r.charCodeAt(o+1)?(o+=2,y(),e.push({kind:"InlineFragment",typeCondition:{kind:"NamedType",name:f()},directives:S(!1),selectionSet:I()})):e.push({kind:"FragmentSpread",name:f(),directives:S(!1)});break;case 123:o++,y(),e.push({kind:"InlineFragment",typeCondition:void 0,directives:void 0,selectionSet:T()});break;default:e.push({kind:"FragmentSpread",name:f(),directives:S(!1)})}}else{var n=f(),t=void 0;58===r.charCodeAt(o)&&(o++,y(),t=n,n=f());var i=b(!1),a=S(!1),s=void 0;123===r.charCodeAt(o)&&(o++,y(),s=T()),e.push({kind:"Field",alias:t,name:n,arguments:i,directives:a,selectionSet:s})}}while(125!==r.charCodeAt(o));return o++,y(),{kind:"SelectionSet",selections:e}}function $(){if(y(),40===r.charCodeAt(o)){var e=[];o++,y();do{if(36!==r.charCodeAt(o++))throw u("Variable");var n=f();if(58!==r.charCodeAt(o++))throw u("VariableDefinition");y();var t=E(),i=void 0;61===r.charCodeAt(o)&&(o++,y(),i=g(!0)),y(),e.push({kind:"VariableDefinition",variable:{kind:"Variable",name:n},type:t,defaultValue:i,directives:S(!0)})}while(41!==r.charCodeAt(o));return o++,y(),e}}function A(){var e=f();if(111!==r.charCodeAt(o++)||110!==r.charCodeAt(o++))throw u("FragmentDefinition");return y(),{kind:"FragmentDefinition",name:e,typeCondition:{kind:"NamedType",name:f()},directives:S(!1),selectionSet:I()}}function C(){var e=[];do{if(123===r.charCodeAt(o))o++,y(),e.push({kind:"OperationDefinition",operation:"query",name:void 0,variableDefinitions:void 0,directives:void 0,selectionSet:T()});else{var n=p();switch(n){case"fragment":e.push(A());break;case"query":case"mutation":case"subscription":var t,i=void 0;40!==(t=r.charCodeAt(o))&&64!==t&&123!==t&&(i=f()),e.push({kind:"OperationDefinition",operation:n,name:i,variableDefinitions:$(),directives:S(!1),selectionSet:I()});break;default:throw u("Document")}}}while(o<r.length);return e}function N(e,n){return r=e.body?e.body:e,o=0,y(),n&&n.noLocation?{kind:"Document",definitions:C()}:{kind:"Document",definitions:C(),loc:{start:0,end:r.length,startToken:void 0,endToken:void 0,source:{body:r,name:"graphql.web",locationOffset:{line:1,column:1}}}}}var x=0,O=new Set;function F(){function e(e,n){var t,i,r=N(e).definitions,o=new Set;for(var c of n||[])for(var u of c.definitions)u.kind!==s||o.has(u)||(r.push(u),o.add(u));return(t=r[0].kind===s)&&r[0].directives&&(r[0].directives=r[0].directives.filter((e=>"_unmask"!==e.name.value))),{kind:a,definitions:r,get loc(){if(!i&&t){var r=e+function(e){try{x++;var n="";for(var t of e)if(!O.has(t)){O.add(t);var{loc:i}=t;i&&(n+=i.source.body)}return n}finally{0==--x&&O.clear()}}(n||[]);return{start:0,end:r.length,source:{body:r,name:"GraphQLTada",locationOffset:{line:1,column:1}}}}return i},set loc(e){i=e}}}return e.scalar=function(e,n){return n},e.persisted=function(e,n){return{kind:a,definitions:n?n.definitions:[],documentId:e}},e}function D(e){return 9===e||32===e}F();const w=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function k(e){return P[e.charCodeAt(0)]}const P=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"];function V(e,n){if(!Boolean(e))throw new Error(n)}function _(e){return j(e,[])}function j(e,n){switch(typeof e){case"string":return JSON.stringify(e);case"function":return e.name?`[function ${e.name}]`:"[function]";case"object":return function(e,n){if(null===e)return"null";if(n.includes(e))return"[Circular]";const t=[...n,e];if(function(e){return"function"==typeof e.toJSON}(e)){const n=e.toJSON();if(n!==e)return"string"==typeof n?n:j(n,t)}else if(Array.isArray(e))return function(e,n){if(0===e.length)return"[]";if(n.length>2)return"[Array]";const t=Math.min(10,e.length),i=e.length-t,r=[];for(let i=0;i<t;++i)r.push(j(e[i],n));return 1===i?r.push("... 1 more item"):i>1&&r.push(`... ${i} more items`),"["+r.join(", ")+"]"}(e,t);return function(e,n){const t=Object.entries(e);if(0===t.length)return"{}";if(n.length>2)return"["+function(e){const n=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===n&&"function"==typeof e.constructor){const n=e.constructor.name;if("string"==typeof n&&""!==n)return n}return n}(e)+"]";const i=t.map((([e,t])=>e+": "+j(t,n)));return"{ "+i.join(", ")+" }"}(e,t)}(e,n);default:return String(e)}}Symbol.toStringTag,Symbol.toStringTag;const q={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},M=new Set(Object.keys(q));function U(e){const n=null==e?void 0:e.kind;return"string"==typeof n&&M.has(n)}var R,L,B;!function(e){e.QUERY="query",e.MUTATION="mutation",e.SUBSCRIPTION="subscription"}(R||(R={})),(B=L||(L={})).NAME="Name",B.DOCUMENT="Document",B.OPERATION_DEFINITION="OperationDefinition",B.VARIABLE_DEFINITION="VariableDefinition",B.SELECTION_SET="SelectionSet",B.FIELD="Field",B.ARGUMENT="Argument",B.FRAGMENT_SPREAD="FragmentSpread",B.INLINE_FRAGMENT="InlineFragment",B.FRAGMENT_DEFINITION="FragmentDefinition",B.VARIABLE="Variable",B.INT="IntValue",B.FLOAT="FloatValue",B.STRING="StringValue",B.BOOLEAN="BooleanValue",B.NULL="NullValue",B.ENUM="EnumValue",B.LIST="ListValue",B.OBJECT="ObjectValue",B.OBJECT_FIELD="ObjectField",B.DIRECTIVE="Directive",B.NAMED_TYPE="NamedType",B.LIST_TYPE="ListType",B.NON_NULL_TYPE="NonNullType",B.SCHEMA_DEFINITION="SchemaDefinition",B.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",B.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",B.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",B.FIELD_DEFINITION="FieldDefinition",B.INPUT_VALUE_DEFINITION="InputValueDefinition",B.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",B.UNION_TYPE_DEFINITION="UnionTypeDefinition",B.ENUM_TYPE_DEFINITION="EnumTypeDefinition",B.ENUM_VALUE_DEFINITION="EnumValueDefinition",B.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",B.DIRECTIVE_DEFINITION="DirectiveDefinition",B.SCHEMA_EXTENSION="SchemaExtension",B.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",B.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",B.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",B.UNION_TYPE_EXTENSION="UnionTypeExtension",B.ENUM_TYPE_EXTENSION="EnumTypeExtension",B.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension";const z=Object.freeze({});function Q(e,n){const t=e[n];return"object"==typeof t?t:"function"==typeof t?{enter:t,leave:void 0}:{enter:e.enter,leave:e.leave}}const K={Name:{leave:e=>e.value},Variable:{leave:e=>"$"+e.name},Document:{leave:e=>Y(e.definitions,"\n\n")},OperationDefinition:{leave(e){const n=G("(",Y(e.variableDefinitions,", "),")"),t=Y([e.operation,Y([e.name,n]),Y(e.directives," ")]," ");return("query"===t?"":t+" ")+e.selectionSet}},VariableDefinition:{leave:({variable:e,type:n,defaultValue:t,directives:i})=>e+": "+n+G(" = ",t)+G(" ",Y(i," "))},SelectionSet:{leave:({selections:e})=>J(e)},Field:{leave({alias:e,name:n,arguments:t,directives:i,selectionSet:r}){const o=G("",e,": ")+n;let a=o+G("(",Y(t,", "),")");return a.length>80&&(a=o+G("(\n",H(Y(t,"\n")),"\n)")),Y([a,Y(i," "),r]," ")}},Argument:{leave:({name:e,value:n})=>e+": "+n},FragmentSpread:{leave:({name:e,directives:n})=>"..."+e+G(" ",Y(n," "))},InlineFragment:{leave:({typeCondition:e,directives:n,selectionSet:t})=>Y(["...",G("on ",e),Y(n," "),t]," ")},FragmentDefinition:{leave:({name:e,typeCondition:n,variableDefinitions:t,directives:i,selectionSet:r})=>`fragment ${e}${G("(",Y(t,", "),")")} on ${n} ${G("",Y(i," ")," ")}`+r},IntValue:{leave:({value:e})=>e},FloatValue:{leave:({value:e})=>e},StringValue:{leave:({value:e,block:n})=>n?function(e){const n=e.replace(/"""/g,'\\"""'),t=n.split(/\r\n|[\n\r]/g),i=1===t.length,r=t.length>1&&t.slice(1).every((e=>0===e.length||D(e.charCodeAt(0)))),o=n.endsWith('\\"""'),a=e.endsWith('"')&&!o,s=e.endsWith("\\"),c=a||s,u=!i||e.length>70||c||r||o;let l="";const d=i&&D(e.charCodeAt(0));return(u&&!d||r)&&(l+="\n"),l+=n,(u||c)&&(l+="\n"),'"""'+l+'"""'}(e):`"${e.replace(w,k)}"`},BooleanValue:{leave:({value:e})=>e?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:e})=>e},ListValue:{leave:({values:e})=>"["+Y(e,", ")+"]"},ObjectValue:{leave:({fields:e})=>"{"+Y(e,", ")+"}"},ObjectField:{leave:({name:e,value:n})=>e+": "+n},Directive:{leave:({name:e,arguments:n})=>"@"+e+G("(",Y(n,", "),")")},NamedType:{leave:({name:e})=>e},ListType:{leave:({type:e})=>"["+e+"]"},NonNullType:{leave:({type:e})=>e+"!"},SchemaDefinition:{leave:({description:e,directives:n,operationTypes:t})=>G("",e,"\n")+Y(["schema",Y(n," "),J(t)]," ")},OperationTypeDefinition:{leave:({operation:e,type:n})=>e+": "+n},ScalarTypeDefinition:{leave:({description:e,name:n,directives:t})=>G("",e,"\n")+Y(["scalar",n,Y(t," ")]," ")},ObjectTypeDefinition:{leave:({description:e,name:n,interfaces:t,directives:i,fields:r})=>G("",e,"\n")+Y(["type",n,G("implements ",Y(t," & ")),Y(i," "),J(r)]," ")},FieldDefinition:{leave:({description:e,name:n,arguments:t,type:i,directives:r})=>G("",e,"\n")+n+(X(t)?G("(\n",H(Y(t,"\n")),"\n)"):G("(",Y(t,", "),")"))+": "+i+G(" ",Y(r," "))},InputValueDefinition:{leave:({description:e,name:n,type:t,defaultValue:i,directives:r})=>G("",e,"\n")+Y([n+": "+t,G("= ",i),Y(r," ")]," ")},InterfaceTypeDefinition:{leave:({description:e,name:n,interfaces:t,directives:i,fields:r})=>G("",e,"\n")+Y(["interface",n,G("implements ",Y(t," & ")),Y(i," "),J(r)]," ")},UnionTypeDefinition:{leave:({description:e,name:n,directives:t,types:i})=>G("",e,"\n")+Y(["union",n,Y(t," "),G("= ",Y(i," | "))]," ")},EnumTypeDefinition:{leave:({description:e,name:n,directives:t,values:i})=>G("",e,"\n")+Y(["enum",n,Y(t," "),J(i)]," ")},EnumValueDefinition:{leave:({description:e,name:n,directives:t})=>G("",e,"\n")+Y([n,Y(t," ")]," ")},InputObjectTypeDefinition:{leave:({description:e,name:n,directives:t,fields:i})=>G("",e,"\n")+Y(["input",n,Y(t," "),J(i)]," ")},DirectiveDefinition:{leave:({description:e,name:n,arguments:t,repeatable:i,locations:r})=>G("",e,"\n")+"directive @"+n+(X(t)?G("(\n",H(Y(t,"\n")),"\n)"):G("(",Y(t,", "),")"))+(i?" repeatable":"")+" on "+Y(r," | ")},SchemaExtension:{leave:({directives:e,operationTypes:n})=>Y(["extend schema",Y(e," "),J(n)]," ")},ScalarTypeExtension:{leave:({name:e,directives:n})=>Y(["extend scalar",e,Y(n," ")]," ")},ObjectTypeExtension:{leave:({name:e,interfaces:n,directives:t,fields:i})=>Y(["extend type",e,G("implements ",Y(n," & ")),Y(t," "),J(i)]," ")},InterfaceTypeExtension:{leave:({name:e,interfaces:n,directives:t,fields:i})=>Y(["extend interface",e,G("implements ",Y(n," & ")),Y(t," "),J(i)]," ")},UnionTypeExtension:{leave:({name:e,directives:n,types:t})=>Y(["extend union",e,Y(n," "),G("= ",Y(t," | "))]," ")},EnumTypeExtension:{leave:({name:e,directives:n,values:t})=>Y(["extend enum",e,Y(n," "),J(t)]," ")},InputObjectTypeExtension:{leave:({name:e,directives:n,fields:t})=>Y(["extend input",e,Y(n," "),J(t)]," ")}};function Y(e,n=""){var t;return null!==(t=null==e?void 0:e.filter((e=>e)).join(n))&&void 0!==t?t:""}function J(e){return G("{\n",H(Y(e,"\n")),"\n}")}function G(e,n,t=""){return null!=n&&""!==n?e+n+t:""}function H(e){return G("  ",e.replace(/\n/g,"\n  "))}function X(e){var n;return null!==(n=null==e?void 0:e.some((e=>e.includes("\n"))))&&void 0!==n&&n}const W=F();class Z{client;constructor(e,n){const t="live"===e.tradingMode?"4567":"5678",i=e.host.includes(t)?e.host:e.host.replace(/\/$/,`:${t}/`),r={Authorization:`Basic ${e.apiKey} ${e.apiSecret}`};"paper"===e.tradingMode&&(r["x-architect-account-mode"]="paper"),this.client=n({url:`${i}graphql`,headers:r})}parse(e){return W(e)}async execute(e,n){return new Promise(((t,i)=>{let r;var o;this.client.subscribe({query:(o=e,function(e,n,t=q){const i=new Map;for(const e of Object.values(L))i.set(e,Q(n,e));let r,o,a,s=Array.isArray(e),c=[e],u=-1,l=[],d=e;const m=[],y=[];do{u++;const e=u===c.length,v=e&&0!==l.length;if(e){if(o=0===y.length?void 0:m[m.length-1],d=a,a=y.pop(),v)if(s){d=d.slice();let e=0;for(const[n,t]of l){const i=n-e;null===t?(d.splice(i,1),e++):d[i]=t}}else{d=Object.defineProperties({},Object.getOwnPropertyDescriptors(d));for(const[e,n]of l)d[e]=n}u=r.index,c=r.keys,l=r.edits,s=r.inArray,r=r.prev}else if(a){if(o=s?u:c[u],d=a[o],null==d)continue;m.push(o)}let g;if(!Array.isArray(d)){var p,f;U(d)||V(!1,`Invalid AST Node: ${_(d)}.`);const t=e?null===(p=i.get(d.kind))||void 0===p?void 0:p.leave:null===(f=i.get(d.kind))||void 0===f?void 0:f.enter;if(g=null==t?void 0:t.call(n,d,o,a,m,y),g===z)break;if(!1===g){if(!e){m.pop();continue}}else if(void 0!==g&&(l.push([o,g]),!e)){if(!U(g)){m.pop();continue}d=g}}var h;void 0===g&&v&&l.push([o,d]),e?m.pop():(r={inArray:s,index:u,keys:c,edits:l,prev:r},s=Array.isArray(d),c=s?d:null!==(h=t[d.kind])&&void 0!==h?h:[],u=-1,l=[],a&&y.push(a),a=d)}while(void 0!==r);return 0!==l.length?l[l.length-1][1]:e}(o,K)),variables:n},{next:e=>{r=e.data},error:e=>i(e),complete:()=>t(r)})}))}async debugAsUser(e){return this.execute(W("mutation DebugAsUser($user: String!) {\n        admin {\n          debugAsUser(user: $user)\n        }\n      }"),{user:e}).then((e=>e.admin.debugAsUser))}async stopDebuggingAsUser(){return this.execute(W("mutation StopDebuggingAsUser {\n        admin {\n          stopDebuggingAsUser\n        }\n      }")).then((e=>e.admin.stopDebuggingAsUser))}async marketdataVenues(){return this.execute(W("query MarketdataVenues {\n        config {\n          marketdataVenues\n        }\n      }")).then((e=>e.config.marketdataVenues))}async cmeProductGroupInfo(e,n){return this.execute(W(`query CmeProductGroupInfo($seriesSymbol: String!) {\n        exchangeSymbology {\n          cmeProductGroupInfo(seriesSymbol: $seriesSymbol) {\n            __typename ${e.join(" ")}\n          }\n        }\n      }`),{seriesSymbol:n}).then((e=>e.exchangeSymbology.cmeProductGroupInfo))}async cmeProductGroupInfos(e,n){return this.execute(W(`query CmeProductGroupInfos($seriesSymbols: [String!]) {\n        exchangeSymbology {\n          cmeProductGroupInfos(seriesSymbols: $seriesSymbols) {\n            __typename ${e.join(" ")}\n          }\n        }\n      }`),{seriesSymbols:n}).then((e=>e.exchangeSymbology.cmeProductGroupInfos))}async accountHistory(e,n){return this.execute(W(`query AccountHistory($account: String!, $fromInclusive: DateTime, $toExclusive: DateTime) {\n        folio {\n          accountHistory(account: $account, fromInclusive: $fromInclusive, toExclusive: $toExclusive) {\n            __typename\n            account\n            timestamp\n            balances {\n              product\n              balance\n            }\n            positions {\n              symbol\n              quantity\n              tradeTime\n              costBasis\n              breakEvenPrice\n              liquidationPrice\n            }\n            unrealizedPnl\n            realizedPnl\n            equity\n            yesterdayEquity\n            cashExcess\n            purchasingPower\n            totalMargin\n            positionMargin\n            ${e.join(" ")}\n          }\n        }\n      }`),n).then((e=>e.folio.accountHistory))}async accountSummaries(e,n,t){return this.execute(W(`query AccountSummaries($accounts: [String!], $trader: String) {\n        folio {\n          accountSummaries(accounts: $accounts, trader: $trader) {\n            __typename\n            account\n            timestamp\n            balances {\n              product\n              balance\n            }\n            positions {\n              symbol\n              quantity\n              tradeTime\n              costBasis\n              breakEvenPrice\n              liquidationPrice\n            }\n            unrealizedPnl\n            realizedPnl\n            equity\n            yesterdayEquity\n            cashExcess\n            purchasingPower\n            totalMargin\n            positionMargin\n            ${e.join(" ")}\n          }\n        }\n      }`),{accounts:n,trader:t}).then((e=>e.folio.accountSummaries))}async accountSummary(e,n){return this.execute(W(`query AccountSummary($account: String!) {\n        folio {\n          accountSummary(account: $account) {\n            __typename\n            account\n            timestamp\n            balances {\n              product\n              balance\n            }\n            positions {\n              symbol\n              quantity\n              tradeTime\n              costBasis\n              breakEvenPrice\n              liquidationPrice\n            }\n            unrealizedPnl\n            realizedPnl\n            equity\n            yesterdayEquity\n            cashExcess\n            purchasingPower\n            totalMargin\n            positionMargin\n            ${e.join(" ")}\n          }\n        }\n      }`),{account:n}).then((e=>e.folio.accountSummary))}async historicalFills(e,n){return this.execute(W(`query HistoricalFills($account: String, $fromInclusive: DateTime, $limit: Int, $orderId: OrderId, $toExclusive: DateTime, $trader: String, $venue: ExecutionVenue) {\n        folio {\n          historicalFills(account: $account, fromInclusive: $fromInclusive, limit: $limit, orderId: $orderId, toExclusive: $toExclusive, trader: $trader, venue: $venue) {\n            __typename\n            fills {\n              fillId\n              fillKind\n              executionVenue\n              exchangeFillId\n              orderId\n              trader\n              account\n              symbol\n              dir\n              quantity\n              price\n              recvTime\n              tradeTime\n            } aberrantFills {\n              fillId\n              fillKind\n              executionVenue\n              exchangeFillId\n              orderId\n              trader\n              account\n              symbol\n              dir\n              quantity\n              price\n              recvTime\n              tradeTime\n            }\n            ${e.join(" ")}\n          }\n        }\n      }`),n).then((e=>e.folio.historicalFills))}async historicalOrders(e,n){return this.execute(W(`query HistoricalOrders($account: String, $fromInclusive: DateTime, $limit: Int, $orderIds: [OrderId!], $parentOrderId: OrderId, $toExclusive: DateTime, $trader: String, $venue: ExecutionVenue) {\n        folio {\n          historicalOrders(account: $account, fromInclusive: $fromInclusive, limit: $limit, orderIds: $orderIds, parentOrderId: $parentOrderId, toExclusive: $toExclusive, trader: $trader, venue: $venue) {\n            __typename\n            id\n            parentId\n            recvTime\n            status\n            rejectReason\n            rejectMessage\n            symbol\n            trader\n            account\n            dir\n            quantity\n            filledQuantity\n            averageFillPrice\n            orderType\n            limitPrice\n            postOnly\n            triggerPrice\n            timeInForce\n            goodTilDate\n            source\n            executionVenue\n            ${e.join(" ")}\n          }\n        }\n      }`),n).then((e=>e.folio.historicalOrders))}async historicalCandles(e,n){return this.execute(W(`query HistoricalCandles($venue: MarketdataVenue!, $symbol: String!, $start: DateTime!, $end: DateTime!, $candleWidth: CandleWidth!) {\n        marketdata {\n          historicalCandles(venue: $venue, symbol: $symbol, start: $start, end: $end, candleWidth: $candleWidth) {\n            __typename\n            timestamp\n            width\n            open\n            high\n            low\n            close\n            volume\n            ${e.join(" ")}\n          }\n        }\n      }`),n).then((e=>e.marketdata.historicalCandles))}async l2BookSnapshot(e,n,t){return this.execute(W(`query L2BookSnapshot($symbol: String!, $venue: MarketdataVenue) {\n        marketdata {\n          l2BookSnapshot(symbol: $symbol, venue: $venue) {\n            __typename\n            timestamp\n            bids {\n              price\n              size\n            }\n            asks {\n              price\n              size\n            }\n            ${e.join(" ")}\n          }\n        }\n      }`),{symbol:n,venue:t}).then((e=>e.marketdata.l2BookSnapshot))}async marketStatus(e,n,t){return this.execute(W(`query MarketStatus($symbol: String!, $venue: MarketdataVenue) {\n        marketdata {\n          marketStatus(symbol: $symbol, venue: $venue) {\n            __typename\n            symbol\n            isTrading\n            isQuoting\n            ${e.join(" ")}\n          }\n        }\n      }`),{symbol:n,venue:t}).then((e=>e.marketdata.marketStatus))}async ticker(e,n,t){return this.execute(W(`query Ticker($symbol: String!, $venue: MarketdataVenue) {\n        marketdata {\n          ticker(symbol: $symbol, venue: $venue) {\n            __typename\n            symbol\n            timestamp\n            bidPrice\n            bidSize\n            askPrice\n            askSize\n            lastPrice\n            lastSize\n            ${e.join(" ")}\n          }\n        }\n      }`),{symbol:n,venue:t}).then((e=>e.marketdata.ticker))}async tickers(e,n){return this.execute(W(`query Tickers($venue: MarketdataVenue!, $limit: Int, $offset: Int, $sortBy: SortTickersBy, $symbols: [String!]) {\n        marketdata {\n          tickers(venue: $venue, limit: $limit, offset: $offset, sortBy: $sortBy, symbols: $symbols) {\n            __typename\n            symbol\n            timestamp\n            bidPrice\n            bidSize\n            askPrice\n            askSize\n            lastPrice\n            lastSize\n            ${e.join(" ")}\n          }\n        }\n      }`),n).then((e=>e.marketdata.tickers))}async cancelAllOrders(e){return this.execute(W("mutation CancelAllOrders($account: String, $executionVenue: String, $trader: String) {\n        oms {\n          cancelAllOrders(account: $account, executionVenue: $executionVenue, trader: $trader)\n        }\n      }"),e).then((e=>e.oms.cancelAllOrders))}async cancelOrder(e,n){return this.execute(W(`mutation CancelOrder($orderId: OrderId!) {\n        oms {\n          cancelOrder(orderId: $orderId) {\n            __typename\n            cancelId\n            orderId\n            recvTime\n            status\n            rejectReason\n            ${e.join(" ")}\n          }\n        }\n      }`),{orderId:n}).then((e=>e.oms.cancelOrder))}async placeOrder(e,n){return this.execute(W(`mutation PlaceOrder($timeInForce: TimeInForce!, $symbol: String!, $quantity: Decimal!, $orderType: OrderType!, $dir: Dir!, $account: String, $executionVenue: ExecutionVenue, $goodTilDate: DateTime, $id: OrderId, $limitPrice: Decimal, $postOnly: Boolean, $trader: String, $triggerPrice: Decimal) {\n        oms {\n          placeOrder(timeInForce: $timeInForce, symbol: $symbol, quantity: $quantity, orderType: $orderType, dir: $dir, account: $account, executionVenue: $executionVenue, goodTilDate: $goodTilDate, id: $id, limitPrice: $limitPrice, postOnly: $postOnly, trader: $trader, triggerPrice: $triggerPrice) {\n            __typename\n            id\n            parentId\n            recvTime\n            status\n            rejectReason\n            rejectMessage\n            symbol\n            trader\n            account\n            dir\n            quantity\n            filledQuantity\n            averageFillPrice\n            orderType\n            limitPrice\n            postOnly\n            triggerPrice\n            timeInForce\n            goodTilDate\n            source\n            executionVenue\n            ${e.join(" ")}\n          }\n        }\n      }`),n).then((e=>e.oms.placeOrder))}async openOrders(e,n){return this.execute(W(`query OpenOrders($account: String, $orderIds: [OrderId!], $parentOrderId: OrderId, $symbol: String, $trader: String, $venue: ExecutionVenue) {\n        oms {\n          openOrders(account: $account, orderIds: $orderIds, parentOrderId: $parentOrderId, symbol: $symbol, trader: $trader, venue: $venue) {\n            __typename\n            id\n            parentId\n            recvTime\n            status\n            rejectReason\n            rejectMessage\n            symbol\n            trader\n            account\n            dir\n            quantity\n            filledQuantity\n            averageFillPrice\n            orderType\n            limitPrice\n            postOnly\n            triggerPrice\n            timeInForce\n            goodTilDate\n            source\n            executionVenue\n            ${e.join(" ")}\n          }\n        }\n      }`),n).then((e=>e.oms.openOrders))}async pendingCancels(e,n){return this.execute(W(`query PendingCancels($account: String, $cancelIds: [Uuid!], $symbol: String, $trader: String, $venue: ExecutionVenue) {\n        oms {\n          pendingCancels(account: $account, cancelIds: $cancelIds, symbol: $symbol, trader: $trader, venue: $venue) {\n            __typename ${e.join(" ")}\n          }\n        }\n      }`),n).then((e=>e.oms.pendingCancels))}async version(){return this.execute(W("query Version {\nversion\n      }")).then((e=>e.version))}async exchangeSymbology(e){return this.execute(W(`query ExchangeSymbology {\n        symbology {\n          exchangeSymbology {\n            __typename ${e.join(" ")}\n          }\n        }\n      }`)).then((e=>e.symbology.exchangeSymbology))}async executionInfo(e,n,t){return this.execute(W(`query ExecutionInfo($symbol: TradableProduct!, $executionVenue: ExecutionVenue!) {\n        symbology {\n          executionInfo(symbol: $symbol, executionVenue: $executionVenue) {\n            __typename\n            symbol\n            executionVenue\n            tickSize\n            stepSize\n            minOrderQuantity\n            minOrderQuantityUnit\n            isDelisted\n            initialMargin\n            maintenanceMargin\n            ${e.join(" ")}\n          }\n        }\n      }`),{symbol:n,executionVenue:t}).then((e=>e.symbology.executionInfo))}async executionInfos(e,n,t){return this.execute(W(`query ExecutionInfos($executionVenue: ExecutionVenue, $symbols: [TradableProduct!]) {\n        symbology {\n          executionInfos(executionVenue: $executionVenue, symbols: $symbols) {\n            __typename\n            symbol\n            executionVenue\n            tickSize\n            stepSize\n            minOrderQuantity\n            minOrderQuantityUnit\n            isDelisted\n            initialMargin\n            maintenanceMargin\n            ${e.join(" ")}\n          }\n        }\n      }`),{executionVenue:n,symbols:t}).then((e=>e.symbology.executionInfos))}async futuresSeries(e){return this.execute(W("query FuturesSeries($seriesSymbol: String!) {\n        symbology {\n          futuresSeries(seriesSymbol: $seriesSymbol)\n        }\n      }"),{seriesSymbol:e}).then((e=>e.symbology.futuresSeries))}async productInfo(e,n){return this.execute(W(`query ProductInfo($symbol: String!) {\n        symbology {\n          productInfo(symbol: $symbol) {\n            __typename\n            __typename\n            symbol\n            productType\n            underlying\n            multiplier\n            derivativeKind\n            firstNoticeDate\n            primaryVenue\n            priceDisplayFormat\n            spreadLegs {\n              product\n              quantity\n            }\n            ${e.join(" ")}\n          }\n        }\n      }`),{symbol:n}).then((e=>e.symbology.productInfo))}async productInfos(e,n){return this.execute(W(`query ProductInfos($symbols: [String!]) {\n        symbology {\n          productInfos(symbols: $symbols) {\n            __typename\n            __typename\n            symbol\n            productType\n            underlying\n            multiplier\n            derivativeKind\n            firstNoticeDate\n            primaryVenue\n            priceDisplayFormat\n            spreadLegs {\n              product\n              quantity\n            }\n            ${e.join(" ")}\n          }\n        }\n      }`),{symbols:n}).then((e=>e.symbology.productInfos))}async searchSymbols(e){return this.execute(W("query SearchSymbols($executionVenue: ExecutionVenue, $limit: Int, $offset: Int, $searchString: String) {\n        symbology {\n          searchSymbols(executionVenue: $executionVenue, limit: $limit, offset: $offset, searchString: $searchString)\n        }\n      }"),e).then((e=>e.symbology.searchSymbols))}async createApiKey(e){return this.execute(W(`mutation CreateApiKey {\n        user {\n          createApiKey {\n            __typename ${e.join(" ")}\n          }\n        }\n      }`)).then((e=>e.user.createApiKey))}async createJwt(){return this.execute(W("mutation CreateJwt {\n        user {\n          createJwt\n        }\n      }")).then((e=>e.user.createJwt))}async enablePaperTrading(){return this.execute(W("mutation EnablePaperTrading {\n        user {\n          enablePaperTrading\n        }\n      }")).then((e=>e.user.enablePaperTrading))}async removeApiKey(e){return this.execute(W("mutation RemoveApiKey($apiKey: String!) {\n        user {\n          removeApiKey(apiKey: $apiKey)\n        }\n      }"),{apiKey:e}).then((e=>e.user.removeApiKey))}async account(e,n,t){return this.execute(W(`query Account($id: Uuid, $name: AccountName) {\n        user {\n          account(id: $id, name: $name) {\n            __typename\n            account {\n              id\n              name\n            }\n            trader\n            permissions {\n              list\n              view\n              trade\n              reduceOrClose\n              setLimits\n            }\n            ${e.join(" ")}\n          }\n        }\n      }`),{id:n,name:t}).then((e=>e.user.account))}async accounts(e){return this.execute(W(`query Accounts {\n        user {\n          accounts {\n            __typename\n            account {\n              id\n              name\n            }\n            trader\n            permissions {\n              list\n              view\n              trade\n              reduceOrClose\n              setLimits\n            }\n            ${e.join(" ")}\n          }\n        }\n      }`)).then((e=>e.user.accounts))}async apiKeys(e){return this.execute(W(`query ApiKeys {\n        user {\n          apiKeys {\n            __typename ${e.join(" ")}\n          }\n        }\n      }`)).then((e=>e.user.apiKeys))}async canDebugAsUser(){return this.execute(W("query CanDebugAsUser {\n        user {\n          canDebugAsUser\n        }\n      }")).then((e=>e.user.canDebugAsUser))}async debuggingAsUser(){return this.execute(W("query DebuggingAsUser {\n        user {\n          debuggingAsUser\n        }\n      }")).then((e=>e.user.debuggingAsUser))}async userEmail(){return this.execute(W("query UserEmail {\n        user {\n          userEmail\n        }\n      }")).then((e=>e.user.userEmail))}async userId(){return this.execute(W("query UserId {\n        user {\n          userId\n        }\n      }")).then((e=>e.user.userId))}}let ee={host:"https://app.architect.co/",apiKey:"",apiSecret:"",tradingMode:"live"},ne=new Proxy({},{get(e,n){throw new Error("Client is not initialized")},set(e,n,t){throw new Error("Client is not initialized")}});const te=e=>{if(!(null==e||Array.isArray(e)&&0===e.length))return Array.isArray(e)&&Array.isArray(e[0])?e.flat().map(String).filter(Boolean):Array.isArray(e)?e.map(String):"string"==typeof e?[e]:void 0};function ie(e,n){ee.apiKey=e,ee.apiSecret=n,ne=function(e){return new Z(e,t)}(ee),console.log("Client recreated with new config.")}async function re(){let e,n;try{const{ArchitectApiKey:t=null,ArchitectApiSecret:i=null}=await OfficeRuntime.storage.getItems(["ArchitectApiKey","ArchitectApiSecret"]);e=t,n=i}catch(t){console.log("Error accessing storage."),e=null,n=null}if(!e)throw new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,"api_key has not been input");if(!n)throw new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,"api_secret has not been input");ie(e,n);try{let e=await ne.userEmail();return console.log("Client initialized successfully. User email:",e),e}catch(e){throw console.error("Client failed to initialize. Please check your API key and secret: ",e),new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,"Client failed to initialize. Please check your API key and secret.")}}async function oe(e,n){let t=await ne.ticker([],e,n);if(!t)throw new CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable,"Received bad data from the server, please try again.");try{return[[t.bidPrice?parseFloat(t.bidPrice):NaN,t.askPrice?parseFloat(t.askPrice):NaN]]}catch(e){throw new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,"Failed to parse bid/ask prices")}}function ae(e,n,t,i){const r=te(t)??["bidPrice","askPrice","lastPrice"],o=setInterval((async()=>{try{const t=await ne.ticker(r,e,n);if(!t)return void i.setResult([Array(r.length).fill(NaN)]);const o=r.map((e=>((e,n)=>void 0!==e[n]?Number(e[n]):NaN)(t,e)));i.setResult([o])}catch(e){console.error("streamMarketTicker:",e),i.setResult([Array(r.length).fill(NaN)])}}),1e3);i.onCanceled=()=>clearInterval(o)}async function se(e,n){let t=await oe(e,n),i=t[0][1],r=t[0][0];return isNaN(r)||isNaN(i)?NaN:(r+i)/2}async function ce(e,n,t){const i=te(t)??["bidPrice","bidSize","askPrice","askSize","lastPrice","lastSize"];try{const t=await ne.ticker([],e,n);if(!t)throw new CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable,"Received bad data from the server, please try again.");const r=i.map((e=>((e,n)=>void 0!==e[n]?Number(e[n]):NaN)(t,e)));return[r]}catch(e){if(e instanceof CustomFunctions.Error)throw e;throw new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,"Failed to fetch or parse market data.")}}async function ue(){const e=await ne.accounts([]);if(!e)throw new CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable,"Received bad data from the server, please try again.");const n=[];n.push(["Account Name","Trader","Trade Permission","View Permission"]),e.forEach((e=>{n.push([e.account.name,e.trader,e.permissions.trade.toString(),e.permissions.view.toString()])}));try{return n}catch(e){throw new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,"Failed to parse account data")}}function le(e,n,t,i){const r=["Symbol","NetPosition","Cost Basis"],o=te(n)??[],a=t??!1,s=setInterval((async()=>{try{const n=await ne.accountSummary([],e);if(!n)return void i.setResult([["Error: No data available"]]);const t=new Map(n.positions.map((e=>[e.symbol,e])));let s;s=a?Array.from(new Set([...t.keys(),...o])):o.length?o:Array.from(t.keys());const c=[[n.timestamp,"",""],r,...s.map((e=>{const n=t.get(e);return n?[n.symbol,n.quantity.toString(),null!=n.costBasis?n.costBasis.toString():"NaN"]:[e,"0","0"]}))];i.setResult(c)}catch(e){console.error("streamAccountPositionValues:",e),i.setResult([["Error fetching data"]])}}),1e3);i.onCanceled=()=>clearInterval(s)}async function de(e){let n=await ne.accountSummary([],e);if(!n)throw new CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable,"Received bad data from the server, please try again.");let t=n.cashExcess?parseFloat(n.cashExcess):NaN,i=n.equity?parseFloat(n.equity):NaN,r=n.positionMargin?parseFloat(n.positionMargin):NaN,o=n.purchasingPower?parseFloat(n.purchasingPower):NaN,a=n.realizedPnl?parseFloat(n.realizedPnl):NaN,s=n.unrealizedPnl?parseFloat(n.unrealizedPnl):NaN,c=n.totalMargin?parseFloat(n.totalMargin):NaN,u=n.yesterdayEquity?parseFloat(n.yesterdayEquity):NaN;try{return[[t,i,r,o,a,s,c,u]]}catch(e){throw new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,"Failed to parse account summary snapshot")}}async function me(e){let n=await ne.accountSummary([],e);if(!n)throw new CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable,"Received bad data from the server, please try again.");let t=0;n.balances.forEach((e=>{"USD"==e.product&&(t=parseFloat(e.balance))}));try{return t}catch(e){throw new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,"Failed to parse account summary snapshot")}}async function ye(e,n){const t=function(e){const n=e.match(/([A-Za-z]+|M)(\d{1,2})/);if(!n)throw new Error(`Invalid expiration format: ${e}`);let t=n[1],i=n[2];t.length>1&&(t=t.substring(0,3));const r={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12",F:"01",G:"02",H:"03",J:"04",K:"05",M:"06",N:"07",Q:"08",U:"09",V:"10",X:"11",Z:"12"}[t];if(!r)throw new Error(`Invalid month abbreviation: ${t}`);return`${1===i.length?`202${i}`:`20${i}`}${r}`}(n),i=`${e} ${t}`,r=await ne.searchSymbols({searchString:i});for(const n of r)if(n.includes(e)&&n.includes(t))return n;throw new CustomFunctions.Error(CustomFunctions.ErrorCode.notAvailable,"No symbols found for the given base name and expiration date.")}async function pe(e){return(await ne.searchSymbols({searchString:e})).map((e=>[e]))}function fe(e,n,t,i){if(!n?.length)throw new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,"No symbols provided.");const r=te(n)??[],o=new Set(r),a=0===r.length,s=setInterval((async()=>{const n=function(e){e=e??1,e=Math.trunc(e);const n=new Date,t=new Date(n.toLocaleString("en-US",{timeZone:"America/New_York"})).getTime()-n.getTime(),i=new Date(n.getTime()+t);e&&i.setDate(i.getDate()-e);const r=new Date(i);return r.setHours(17,0,0,0),i<r&&r.setDate(r.getDate()-1),new Date(r.getTime()-t)}(t).toISOString(),s=await ne.historicalFills([],{account:e,fromInclusive:n}),c=s?.fills??[],u=Object.create(null),l=[];for(let e=0;e<c.length;++e){const n=c[e];if(!a&&!o.has(n.symbol))continue;let t=u[n.symbol];t||(t=u[n.symbol]={lastTs:"",tradeCount:0,buyQty:0,buyPQ:0,sellQty:0,sellPQ:0},a&&l.push(n.symbol)),++t.tradeCount;const i=+n.quantity;if(0===i)continue;const r=+n.price;"buy"===n.dir?(t.buyQty+=i,t.buyPQ+=i*r):(t.sellQty+=i,t.sellPQ+=i*r);const s=n.tradeTime??n.recvTime;s&&s>t.lastTs&&(t.lastTs=s)}const d=[["Timestamp","Symbols","TradePosition","TradeCount","AverageBuyPrice","BuyQuantity","AverageSellPrice","SellQuantity"].slice()],m=a?l:r;for(const e of m){const n=u[e];n?d.push([n.lastTs,e,String(n.buyQty-n.sellQty),String(n.tradeCount),n.buyQty?(n.buyPQ/n.buyQty).toFixed(2):"",String(n.buyQty),n.sellQty?(n.sellPQ/n.sellQty).toFixed(2):"",String(n.sellQty)]):d.push(["",e,"","","","","",""])}i.setResult(d)}),1e3);i.onCanceled=()=>clearInterval(s)}return Office.onReady((async e=>{try{await re(),console.log("Client initialized using saved API key/secret")}catch(e){console.log(e)}})),CustomFunctions.associate("INITIALIZECLIENT",re),CustomFunctions.associate("MARKETBBO",oe),CustomFunctions.associate("STREAMMARKETTICKER",ae),CustomFunctions.associate("MARKETMID",se),CustomFunctions.associate("MARKETTICKER",ce),CustomFunctions.associate("ACCOUNTLIST",ue),CustomFunctions.associate("STREAMACCOUNTPOSITIONVALUES",le),CustomFunctions.associate("ACCOUNTPNL",de),CustomFunctions.associate("ACCOUNTBALANCE",me),CustomFunctions.associate("DERIVEFUTURESSYMBOL",ye),CustomFunctions.associate("SEARCHSYMBOLS",pe),CustomFunctions.associate("STREAMFILLSANALYSIS",fe),n}()}));